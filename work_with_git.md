# 3. Работа с Git

LICENSE: [MIT](./license.md)

<img src="./img/git_logo.png" width="100"/>

GIT logo by Jason Long - <http://git-scm.com/downloads/logos>, license: [CC BY 3.0](https://creativecommons.org/licenses/by/3.0)

---
### Содержание:
1. [Создание репозитория](#init)
2. [Создание коммита](#commit)
3. [Просмотр истории](#log)
4. [Работа с удалённым репозиторием](#remote)

---
### <a name="init"></a>	Создание репозитория
Команда `git init` создаёт  git репозитории и директорию .git в текущей директории

Команда `git clone <репозиторий>` клонирует репозиторий в текущую директорию

---
### <a name="commit"></a>	Создание коммита

С помощью команды `git status` можно посмотреть состояние локального репозитория: в какой ветке вы находитесь, какие файлы были изменены, какие добавлены в индекс 

*Индекс* — промежуточное место между вашим прошлым коммитом и следующим. Вы можете добавлять или удалять файлы из индекса. Когда вы делаете коммит в него попадают данные из индекса, а не из рабочей области.

Чтобы добавить файлы в индекс используют команду `git add [<option>]`

Полезные опции:

- `-a` `--all` - добавляет все файлы в индекс
- `-f` `--force` - добавить в том числе игнорируемые файлы
- `-u` `--update` - обновить отслеживаемые файлы

Чтобы удалить из индекса некоторые файлы используйте
`git restore --staged <file>`

Когда индекс находится в нужном нам состоянии используем команду `git commit [<options>]` 

Полезные опции:

- `-F` `--file [file]` - записать сообщение коммита из указанного файла
- `--author [author]` - подменить автора коммита
- `date [date]` - подменить дату коммита
- `-m [message]` `--message [message]` -  сообщение коммита
- `--ammend` - перезаписать предыдущий коммит

---
### <a name="log"></a>	Просмотр истории 

С помощью команды `git log [<options>]` можно историю коммитов репозитория. 

Полезные опции:

- `-p` - показывыет разницу для каждого коммита
- `--stat` — показывает статистику измененных файлов для каждого коммита
- `--graph` - отображает ASCII граф с ветвлениями и историей слияний

Также возможно задать фильтр коммитов:

- `-(n)` - показывает последние n коммитов
- `--since [date]` `--after [date]` - показывает коммиты сделанные после указанной даты
- `--until [date]` `--before [date]` - показывает коммиты сделанные до указанной даты
- `--author` - показывает коммиты определенного автора
- `--grep` - показывает коммиты, содержащие определенную строку

Вывод коммитов в определенном формате `git log --format:["format"]`:

- `%H` — Хеш коммита
- `%h` — Сокращенный хеш коммита
- `%T` — Хеш дерева
- `%t` — Сокращенный хеш дерева
- `%P` — Хеш родителей
- `%p` — Сокращенный хеш родителей
- `%an` — Имя автора
— `%ae` — Электронная почта автора
- `%ad` — Дата автора (формат даты можно задать опцией --date=option)
- `%ar` — Относительная дата автора
- `%cn` — Имя коммитера
- `%ce` — Электронная почта коммитера
- `%cd` — Дата коммитера
- `%cr` — Относительная дата коммитера
- `%s` — Содержание

Команда `git show <hash>` покажет информацию по определённому коммиту

---
### <a name="remote"></a>	Работа с удалённым репозиторием
Так как git это распределённая СКВ вы можете работать не только с локальными но и с внешними репозиториеми.

Удалённые репозитории представляют собой версии вашего проекта, сохранённые на внешнем сервере.

Если вы с клонировали репозитории через http URL то у вас уже имеется ссылка на внешний. В другом случае вы можете добавить её с помощью `git remote add <name> <address>`

Получить новые данные с сервера можно командой `git fetch`. При этом приходит список изменений, но они не вносятся в код, используемый в локальном репозитории.

`git merge` используется для слияния полученных изменений и локального репозитория.

`git pull` является объединением двух последовательных команд `git fetch` и `git merge`.

Для загрузки веток на новую ветку используйте `git checkout -b <new_branch_name> <rep/branch>`. 

`git push` производит отправку ваших изменений в репозиторий.

---
[прошлая глава](./setup_git.md) | [на главную](./README.md) | [следующая глава](./branch.md)
